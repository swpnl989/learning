import unittest
import main
from main import conn
from query_generator import query_generator



class TestStringMethods(unittest.TestCase):
    # def main(self):
    #     self.test_2()

    def test_1(self):                   # Test - fetch all data 
        host = "localhost"
        port ="27017"
        database_name = "demoDatabase"
        table_name = "user_details"
        column_name = []
        where = {}

        conn_str = f"mongodb://{host}:{port}/"
        sm = conn(conn_str,database_name,table_name)
        # query_agg = query_generator()
        try:    
            self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]),[{'name': 'abc', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'name': 'smt', 'age': '30', 'address': 'Nagpur', 'hobbies': ['news', 'Sports']}, {'name': 'bbb', 'age': '20', 'address': 'Solapur', 'hobbies': ['Football', 'cooking']}, {'name': 'ggg', 'age': '26', 'address': 'Mumbai', 'hobbies': ['Cricket', 'Football']}, {'name': 'xyz', 'age': '27', 'address': 'Mumbai', 'hobbies': ['Cooking', 'Sports']}, {'name': 'Chuck', 'address': 'chennai'}, {'name': 'Viola', 'address': 'Sideway 1633'}, {'name': 'Chuck', 'address': 'kolkata'}, {'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'sl', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '22', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'name': 'sl', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '28', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '26'}, {'name': 'jayant', 'age': '16'}, {'name': 'jayant', 'age': '23'}, {'name': 'jayant', '': '26'}, {'name': 'jayant', '': '26'}, {'name': 'sushant', 'age': '500', 'address': 'baramati'}, {'name': 'swap', 'age': '26', 'address': 'Pune'}, {'name': 'sk', 'age': '27', 'address': 'Pune', 'married': True}, {'age': '26', 'name': 'swa', 'address': 'Pune', 'married': False}, {'name': 'sss', 'age': '39', 'address': 'Pune', 'married': False}, {'name': 'ghj', 'age': '28', 'address': 'Pune'}, {'name': 'swap', 'age': '26', 'address': 'Pune'}, {'name': 'Nil', 'age': '27', 'address': 'LA'}, {'name': 'ak', 'age': '28', 'address': 'Delhi'}, {'name': 'sl', 'age': '21', 'address': 'Pune'}, {'name': 'swap', 'age': '27', 'adress': 'Nagpur', 'married': True}, {'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}, {'name': 'nil', 'age': '27', 'address': 'Pune', 'married': False}, {'name': 'sk', 'age': '30', 'address': 'nagpur', 'married': True}, {'name': 'swap', 'age': '37', 'address': 'Pune'}, {'name': 'sw', 'age': '26', 'address': 'Pune'}, {'name': 'swap', 'age': '23', 'address': 'Pune'}, {'name': 'smt', 'age': '34', 'address': 'Nagpur'}, {'name': 'dd', 'age': '23', 'adress': 'Jalgao', 'married': True}, {'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'swapnil', 'age': '28', 'address': 'Pune', 'married': True}, {'name': 'pk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'kk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'hj', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'dk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'kj', 'age': '27', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '26', 'address': 'pune', 'hobbies': [''], 'married': [True]}, {'name': 'pk', 'age': '55', 'address': 'gotkhindi', 'hobbies': ['farming', 'cricket'], 'married': 'true'}, {'name': 'p', 'age': '5', 'address': 's', 'hobbies': ['cooking', 'cricket'], 'married': True}, {'name': 'sl', 'age': '500', 'address': 'baramati', 'hobbies': ['treading', 'cricket'], 'married': True}, {'name': 'hj', 'age': '34', 'address': 'pune', 'hobbies': ['farming', 'football'], 'married': True}, {'name': 'hj', 'age': '45', 'address': 'Pune', 'hobbies': ['farming', 'cooking'], 'marriage': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'hj', 'age': '34', 'address': 'Pune', 'hobbies': ['cricket', 'football'], 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'kk', 'age': '56', 'address': ['Pune', ' Nagpur'], 'hobbies': 'farming', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {"{'name'": [" 'bbbbbb'"], " 'age'": [" '2323'"], " 'adress'": [" 'jalgao'"], " 'married'": [' true']}, {"{'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {"'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {'name': 'ZZZZ', 'age': 23, 'adress': 'Jalgao', 'married': True}, {'name': 'HHH', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'CCCCC', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'ASDF', 'age': '40', 'adress': 'Bhelgao', 'married': False}, {'name': 'FDSA', 'age': '83', 'adress': 'Pulgao', 'married': False}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'name': 'Swapnil', 'age': '19', 'adress': 'jammgao', 'married': False}, {'name': 'Nilay', 'age': '9', 'adress': 'Mul', 'married': False}, {'name': 'Nilesh', 'age': '19', 'adress': 'jammgao', 'married': False}, {'name': 'Monaj', 'age': '22', 'adress': 'Mul', 'married': False}])
        except AssertionError as e:
            print("exception handled as {e}")
            exit(1)

    #     self.test_2()

    # def test_2(self):                        
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}

    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]),[{'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'sk', 'age': '27', 'address': 'Pune', 'married': True}])

    # def test_3(self):
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}

    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]),[{'name': 'abc', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'name': 'smt', 'age': '30', 'address': 'Nagpur', 'hobbies': ['news', 'Sports']}, {'name': 'bbb', 'age': '20', 'address': 'Solapur', 'hobbies': ['Football', 'cooking']}])


    # def test_4(self):                                
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}

    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]),[{'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'CCCCC', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'HHH', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'ZZZZ', 'age': 23, 'adress': 'Jalgao', 'married': True}, {'name': 'dd', 'age': '23', 'adress': 'Jalgao', 'married': True}, {'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'dk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hj', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'hj', 'age': '34', 'address': 'pune', 'hobbies': ['farming', 'football'], 'married': True}, {'name': 'hj', 'age': '34', 'address': 'Pune', 'hobbies': ['cricket', 'football'], 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '26', 'address': 'pune', 'hobbies': [''], 'married': [True]}, {'name': 'kj', 'age': '27', 'address': 'Pune', 'married': True}, {'name': 'kk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'kk', 'age': '56', 'address': ['Pune', ' Nagpur'], 'hobbies': 'farming', 'married': True}, {'name': 'p', 'age': '5', 'address': 's', 'hobbies': ['cooking', 'cricket'], 'married': True}, {'name': 'pk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'sk', 'age': '27', 'address': 'Pune', 'married': True}, {'name': 'sk', 'age': '30', 'address': 'nagpur', 'married': True}, {'name': 'sl', 'age': '500', 'address': 'baramati', 'hobbies': ['treading', 'cricket'], 'married': True}, {'name': 'swap', 'age': '27', 'adress': 'Nagpur', 'married': True}, {'name': 'swapnil', 'age': '28', 'address': 'Pune', 'married': True}]) 
  

        # Want to sort and limit press Y/N: n
        # Want to sort only press Y/N: y
        # Enter sort column with boolean sort only :name
        # Enter column name(fields) to chech True or False: married
        # Enter a condition  1.Equal to,2.Not equal:1
        # Enter a value True or False: true


    #    def test_5(self):
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}

    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]),[{'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'name': 'ZZZZ', 'age': 23, 'adress': 'Jalgao', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'name': 'HHH', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'CCCCC', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'dd', 'age': '23', 'adress': 'Jalgao', 'married': True}, {'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '26', 'address': 'pune', 'hobbies': [''], 'married': [True]}, {'name': 'sk', 'age': '27', 'address': 'Pune', 'married': True}, {'name': 'swap', 'age': '27', 'adress': 'Nagpur', 'married': True}, {'name': 'kj', 'age': '27', 'address': 'Pune', 'married': True}, {'name': 'swapnil', 'age': '28', 'address': 'Pune', 'married': True}, {'name': 'sk', 'age': '30', 'address': 'nagpur', 'married': True}, {'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'pk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'kk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'hj', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'dk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'hj', 'age': '34', 'address': 'pune', 'hobbies': ['farming', 'football'], 'married': True}, {'name': 'hj', 'age': '34', 'address': 'Pune', 'hobbies': ['cricket', 'football'], 'married': True}, {'name': 'p', 'age': '5', 'address': 's', 'hobbies': ['cooking', 'cricket'], 'married': True}, {'name': 'sl', 'age': '500', 'address': 'baramati', 'hobbies': ['treading', 'cricket'], 'married': True}, {'name': 'kk', 'age': '56', 'address': ['Pune', ' Nagpur'], 'hobbies': 'farming', 'married': True}]) 

        # Want to sort and limit press Y/N: n
        # Want to sort only press Y/N: y
        # Enter sort column with boolean sort only :age
        # Enter column name(fields) to chech True or False: married
        # Enter a condition  1.Equal to,2.Not equal:1
        # Enter a value True or False: true



    #    def test_6(self):
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}

    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]), [{'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}])   


        # Want to sort and limit press Y/N: y
        # Enter sort column with boolean(for sort and limit) :name
        # Enter limit : 3
        # Enter column name(fields) to chech True or False: married
        # Enter a condition  1.Equal to,2.Not equal:1
        # Enter a value True or False: true             


    # def test_7(self):
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}

    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where_clause={},query_agg=[]),[{'name': 'FDSA', 'age': '83', 'adress': 'Pulgao', 'married': False}, {'name': 'ASDF', 'age': '40', 'adress': 'Bhelgao', 'married': False}, {'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}]) 


        # Want to sort and limit press Y/N: y
        # Enter sort column with boolean(for sort and limit) :address
        # Enter limit : 3
        # Enter column name(fields) to chech True or False: married
        # Enter a condition  1.Equal to,2.Not equal:1
        # Enter a value True or False: false
    

    # def test_8(self):
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'name': 'abc', 'age': '26', 'hobbies': ['news', 'Sports']}, {'name': 'smt', 'age': '30', 'hobbies': ['news', 'Sports']}, {'name': 'bbb', 'age': '20', 'hobbies': ['Football', 'cooking']}, {'name': 'ggg', 'age': '26', 'hobbies': ['Cricket', 'Football']}, {'name': 'xyz', 'age': '27', 'hobbies': ['Cooking', 'Sports']}, {'name': 'Chuck'}, {'name': 'Viola'}, {'name': 'Chuck'}, {'name': 'jk', 'age': '32', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '26', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'sl', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '22', 'hobbies': ['news', 'Sports']}, {'name': 'sl', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '26', 'hobbies': ['news', 'Sports'], 'married': True}, {'name': 'jk', 'age': '26', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '28', 'hobbies': ['news', 'Sports']}, {'name': 'jk', 'age': '26'}, {'name': 'jayant', 'age': '16'}, {'name': 'jayant', 'age': '23'}, {'name': 'jayant', '': '26'}, {'name': 'jayant', '': '26'}, {'name': 'sushant', 'age': '500'}, {'name': 'swap', 'age': '26'}, {'name': 'sk', 'age': '27', 'married': True}, {'age': '26', 'name': 'swa', 'married': False}, {'name': 'sss', 'age': '39', 'married': False}, {'name': 'ghj', 'age': '28'}, {'name': 'swap', 'age': '26'}, {'name': 'Nil', 'age': '27'}, {'name': 'ak', 'age': '28'}, {'name': 'sl', 'age': '21'}, {'name': 'swap', 'age': '27', 'adress': 'Nagpur', 'married': True}, {'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}, {'name': 'nil', 'age': '27', 'married': False}, {'name': 'sk', 'age': '30', 'married': True}, {'name': 'swap', 'age': '37'}, {'name': 'sw', 'age': '26'}, {'name': 'swap', 'age': '23'}, {'name': 'smt', 'age': '34'}, {'name': 'dd', 'age': '23', 'adress': 'Jalgao', 'married': True}, {'name': 'dd', 'age': '34', 'married': True}, {'name': 'dd', 'age': '34', 'married': True}, {'name': 'swapnil', 'age': '28', 'married': True}, {'name': 'pk', 'age': '34', 'married': True}, {'name': 'kk', 'age': '34', 'married': True}, {'name': 'hj', 'age': '34', 'married': True}, {'name': 'dk', 'age': '34', 'married': True}, {'name': 'jk', 'age': '34', 'married': True}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'kj', 'age': '27', 'married': True}, {'name': 'jk', 'age': '26', 'hobbies': [''], 'married': [True]}, {'name': 'pk', 'age': '55', 'hobbies': ['farming', 'cricket'], 'married': 'true'}, {'name': 'p', 'age': '5', 'hobbies': ['cooking', 'cricket'], 'married': True}, {'name': 'sl', 'age': '500', 'hobbies': ['treading', 'cricket'], 'married': True}, {'name': 'hj', 'age': '34', 'hobbies': ['farming', 'football'], 'married': True}, {'name': 'hj', 'age': '45', 'hobbies': ['farming', 'cooking'], 'marriage': True}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'hj', 'age': '34', 'hobbies': ['cricket', 'football'], 'married': True}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'kk', 'age': '56', 'hobbies': 'farming', 'married': True}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {"{'name'": [" 'bbbbbb'"], " 'age'": [" '2323'"], " 'adress'": [" 'jalgao'"], " 'married'": [' true']}, {"{'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {"'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {'name': 'ZZZZ', 'age': 23, 'adress': 'Jalgao', 'married': True}, {'name': 'HHH', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'name': 'CCCCC', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'name': 'ASDF', 'age': '40', 'adress': 'Bhelgao', 'married': False}, {'name': 'FDSA', 'age': '83', 'adress': 'Pulgao', 'married': False}, {'name': 'hk', 'age': 34, 'married': True}, {'name': 'gh', 'age': 54, 'married': True}, {'name': 'gt', 'age': 21, 'married': True}, {'name': 'bg', 'age': 32, 'married': False}, {'name': 'hn', 'age': 21, 'married': True}, {'name': 'gr', 'age': 43, 'married': False}, {'name': 'Swapnil', 'age': '19', 'adress': 'jammgao', 'married': False}, {'name': 'Nilay', 'age': '9', 'adress': 'Mul', 'married': False}, {'name': 'Nilesh', 'age': '19', 'adress': 'jammgao', 'married': False}, {'name': 'Monaj', 'age': '22', 'adress': 'Mul', 'married': False}])                 


    # def test_9(self):                    #[{'$match': {'name': 'jk'}}]
    #     host = "localhost"
    #     port ="27017"
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c201010edc2134ca77f5'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebc'), 'name': 'jk', 'age': '22', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d2d97e72b068e81cbb03'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364d52ad5fc322dbdad1b16'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d6573b01b8fb134075c8'), 'name': 'jk', 'age': '28', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6365032d6948fd52f2ccede4'), 'name': 'jk', 'age': '26'}, {'_id': ObjectId('637758b3e73f610f622d2ddf'), 'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b820a8f7e55363b237e3f'), 'name': 'jk', 'age': '26', 'address': 'pune', 'hobbies': [''], 'married': [True]}])


    # def test_10(self):
    #     host = "localhost"
    #     port ="27017"                        #[{'$match': {'name': 'jk'}}, {'$match': {'address': 'Pune'}}]
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c201010edc2134ca77f5'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebc'), 'name': 'jk', 'age': '22', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d2d97e72b068e81cbb03'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364d52ad5fc322dbdad1b16'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d6573b01b8fb134075c8'), 'name': 'jk', 'age': '28', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}])


    # def test_11(self):
    #     host = "localhost"                         #[{'$match': {'name': 'jk'}}, {'$match': {'age': {'$gt': '28'}}}]
    #     port ="27017"                        
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}])    

    # def test_12(self):
    #     host = "localhost"                         
    #     port ="27017"                        
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}                       #[{'$match': {'name': 'jk'}}, {'$match': {'age': {'$gt': '30'}}}, {'$match': {'address': 'Pune'}}]
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}])



    # def test_13(self):
    #     host = "localhost"                         
    #     port ="27017"                         #[{'$sort': {'name': -1}}]
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6360e724fd5a3e4d438641bf'), 'name': 'xyz', 'age': '27', 'address': 'Mumbai', 'hobbies': ['Cooking', 'Sports']}, {'_id': ObjectId('6377a440079e68777eb693cd'), 'name': 'swapnil', 'age': '28', 'address': 'Pune', 'married': True}, {'_id': ObjectId('6375f439758a325328667231'), 'name': 'swap', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('637634afda75e8409af585f6'), 'name': 'swap', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('63775896e73f610f622d2ddd'), 'name': 'swap', 'age': '27', 'adress': 'Nagpur', 'married': True}, {'_id': ObjectId('6377873d30f0cd2e0cffbe06'), 'name': 'swap', 'age': '37', 'address': 'Pune'}, {'_id': ObjectId('6377880341de59f19a0bf5b8'), 'name': 'swap', 'age': '23', 'address': 'Pune'}, {'_id': ObjectId('637606572330a06b2e76adc8'), 'age': '26', 'name': 'swa', 'address': 'Pune', 'married': False}, {'_id': ObjectId('637787c4eceefa863611c9aa'), 'name': 'sw', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('637211940fbe560932592ce1'), 'name': 'sushant', 'age': '500', 'address': 'baramati'}, {'_id': ObjectId('63760b7b72f053b9078a2c7b'), 'name': 'sss', 'age': '39', 'address': 'Pune', 'married': False}, {'_id': ObjectId('6360e6b11c50d4c7808ab95c'), 'name': 'smt', 'age': '30', 'address': 'Nagpur', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6377881d41de59f19a0bf5ba'), 'name': 'smt', 'age': '34', 'address': 'Nagpur'}, {'_id': ObjectId('6364c201010edc2134ca77f6'), 'name': 'sl', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebd'), 'name': 'sl', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6377081b8fae0ba9a0db78d0'), 'name': 'sl', 'age': '21', 'address': 'Pune'}, {'_id': ObjectId('637b874ac5be986212e08548'), 'name': 'sl', 'age': '500', 'address': 'baramati', 'hobbies': ['treading', 'cricket'], 'married': True}, {'_id': ObjectId('637605d75e9cd23fcba7b9cb'), 'name': 'sk', 'age': '27', 'address': 'Pune', 'married': True}, {'_id': ObjectId('63775b4ad412ac8f13de7f4e'), 'name': 'sk', 'age': '30', 'address': 'nagpur', 'married': True}, {'_id': ObjectId('637b241db05d894d07033e27'), 'name': 'pk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b859ae669eaf727e22f06'), 'name': 'pk', 'age': '55', 'address': 'gotkhindi', 'hobbies': ['farming', 'cricket'], 'married': 'true'}, {'_id': ObjectId('637b86a763f1a906027a77f4'), 'name': 'p', 'age': '5', 'address': 's', 'hobbies': ['cooking', 'cricket'], 'married': True}, {'_id': ObjectId('63775b34d412ac8f13de7f4c'), 'name': 'nil', 'age': '27', 'address': 'Pune', 'married': False}, {'_id': ObjectId('637b248017a5389ef94cdd51'), 'name': 'kk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f680a87acd4324299f4be'), 'name': 'kk', 'age': '56', 'address': ['Pune', ' Nagpur'], 'hobbies': 'farming', 'married': True}, {'_id': ObjectId('637b7e4818a34b482f22171e'), 'name': 'kj', 'age': '27', 'address': 'Pune', 'married': True}, {'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c201010edc2134ca77f5'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebc'), 'name': 'jk', 'age': '22', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d2d97e72b068e81cbb03'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364d52ad5fc322dbdad1b16'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d6573b01b8fb134075c8'), 'name': 'jk', 'age': '28', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6365032d6948fd52f2ccede4'), 'name': 'jk', 'age': '26'}, {'_id': ObjectId('637758b3e73f610f622d2ddf'), 'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b820a8f7e55363b237e3f'), 'name': 'jk', 'age': '26', 'address': 'pune', 'hobbies': [''], 'married': [True]}, {'_id': ObjectId('63650351084cc86a27a429af'), 'name': 'jayant', 'age': '16'}, {'_id': ObjectId('636503567658a522a79fa0cd'), 'name': 'jayant', 'age': '23'}, {'_id': ObjectId('636503a0cf48a2c4af369d83'), 'name': 'jayant', '': '26'}, {'_id': ObjectId('636503a4fa3a34fe2c4a138c'), 'name': 'jayant', '': '26'}, {'_id': ObjectId('637b65d75f524c72d2d317a2'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb377c'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf4'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4bc'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bbe'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abee'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c222'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637b65d75f524c72d2d3179e'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb3778'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf0'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4b8'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bba'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abea'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c21e'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b256fceec39e270daedcb'), 'name': 'hj', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637cba46fc3037333b279ded'), 'name': 'hj', 'age': '34', 'address': 'pune', 'hobbies': ['farming', 'football'], 'married': True}, {'_id': ObjectId('637cbace37a50240f842eef3'), 'name': 'hj', 'age': '45', 'address': 'Pune', 'hobbies': ['farming', 'cooking'], 'marriage': True}, {'_id': ObjectId('637cd1adeb6a73cbc6d04c36'), 'name': 'hj', 'age': '34', 'address': 'Pune', 'hobbies': ['cricket', 'football'], 'married': True}, {'_id': ObjectId('637b65d75f524c72d2d317a0'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb377a'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf2'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4ba'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bbc'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abec'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c220'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637b65d75f524c72d2d317a3'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637cbb6d5ed1021da1cb377d'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf5'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f66f487acd4324299f4bd'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f70a7269e1ddb192f8bbf'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f73961e8d98b9bcc6abef'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('63845f0560fc76a2c766c223'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637632e6701a5d7b4f2e0a67'), 'name': 'ghj', 'age': '28', 'address': 'Pune'}, {'_id': ObjectId('637b65d75f524c72d2d3179f'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb3779'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf1'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4b9'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bbb'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abeb'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c21f'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('6360e724fd5a3e4d438641be'), 'name': 'ggg', 'age': '26', 'address': 'Mumbai', 'hobbies': ['Cricket', 'Football']}, {'_id': ObjectId('637b25ef5fe29b6e92d01c15'), 'name': 'dk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('63779caac65aa5befc21b553'), 'name': 'dd', 'age': '23', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('6377a07c8c57abaa33e77fd7'), 'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('6377a0d68c57abaa33e77fd9'), 'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b65d75f524c72d2d317a1'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637cbb6d5ed1021da1cb377b'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf3'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f66f487acd4324299f4bb'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f70a7269e1ddb192f8bbd'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f73961e8d98b9bcc6abed'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('63845f0560fc76a2c766c221'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('6360e6c8326d9224920daf3b'), 'name': 'bbb', 'age': '20', 'address': 'Solapur', 'hobbies': ['Football', 'cooking']}, {'_id': ObjectId('6377081b8fae0ba9a0db78cf'), 'name': 'ak', 'age': '28', 'address': 'Delhi'}, {'_id': ObjectId('6360e6a13e5c2f58ce4b46a7'), 'name': 'abc', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6380785b07237b8e1019136c'), 'name': 'ZZZZ', 'age': 23, 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('6364b94d7853821924bc88b9'), 'name': 'Viola', 'address': 'Sideway 1633'}, {'_id': ObjectId('6384792f5752913d04906f63'), 'name': 'Swapnil', 'age': '19', 'adress': 'jammgao', 'married': False}, {'_id': ObjectId('6385d45d2fdf1e6b693308ff'), 'name': 'Nilesh', 'age': '19', 'adress': 'jammgao', 'married': False}, {'_id': ObjectId('6384792f5752913d04906f64'), 'name': 'Nilay', 'age': '9', 'adress': 'Mul', 'married': False}, {'_id': ObjectId('637634cfda75e8409af585f8'), 'name': 'Nil', 'age': '27', 'address': 'LA'}, {'_id': ObjectId('6385d45d2fdf1e6b69330900'), 'name': 'Monaj', 'age': '22', 'adress': 'Mul', 'married': False}, {'_id': ObjectId('6380785b07237b8e1019136d'), 'name': 'HHH', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('6380a0bb0f8cd4e1cda88862'), 'name': 'FDSA', 'age': '83', 'adress': 'Pulgao', 'married': False}, {'_id': ObjectId('6364b94d7853821924bc88b8'), 'name': 'Chuck', 'address': 'chennai'}, {'_id': ObjectId('6364ba6427633429653326e8'), 'name': 'Chuck', 'address': 'kolkata'}, {'_id': ObjectId('63809c5a1e40573fe8eaa064'), 'name': 'CCCCC', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('63809c5a1e40573fe8eaa063'), 'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('6380a0bb0f8cd4e1cda88861'), 'name': 'ASDF', 'age': '40', 'adress': 'Bhelgao', 'married': False}, {'_id': ObjectId('637f791ecb5af7428e205a18'), 'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('637f827224f45440e76adf94'), 'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('63806eeb494c0ff2f6dd17e6'), "{'name'": [" 'bbbbbb'"], " 'age'": [" '2323'"], " 'adress'": [" 'jalgao'"], " 'married'": [' true']}, {'_id': ObjectId('63806f5c32fc86f60b2ec7e2'), "{'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {'_id': ObjectId('63806fa10992f4f28b77b25f'), "'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}])  



    # def test_14(self):
    #     host = "localhost"                         
    #     port ="27017"                        
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6364c201010edc2134ca77f6'), 'name': 'sl', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebd'), 'name': 'sl', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6365032d6948fd52f2ccede4'), 'name': 'jk', 'age': '26'}, {'_id': ObjectId('63650351084cc86a27a429af'), 'name': 'jayant', 'age': '16'}, {'_id': ObjectId('636503567658a522a79fa0cd'), 'name': 'jayant', 'age': '23'}, {'_id': ObjectId('636503a0cf48a2c4af369d83'), 'name': 'jayant', '': '26'}, {'_id': ObjectId('636503a4fa3a34fe2c4a138c'), 'name': 'jayant', '': '26'}, {'_id': ObjectId('63775896e73f610f622d2ddd'), 'name': 'swap', 'age': '27', 'adress': 'Nagpur', 'married': True}, {'_id': ObjectId('637758b3e73f610f622d2ddf'), 'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}, {'_id': ObjectId('63779caac65aa5befc21b553'), 'name': 'dd', 'age': '23', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('637f791ecb5af7428e205a18'), 'name': 'AAAAAAA', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('637f827224f45440e76adf94'), 'name': '12edf', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('63806eeb494c0ff2f6dd17e6'), "{'name'": [" 'bbbbbb'"], " 'age'": [" '2323'"], " 'adress'": [" 'jalgao'"], " 'married'": [' true']}, {'_id': ObjectId('63806f5c32fc86f60b2ec7e2'), "{'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {'_id': ObjectId('63806fa10992f4f28b77b25f'), "'name'": " 'bbbbbb'", " 'age'": " '2323'", " 'adress'": " 'jalgao'", " 'married'": ' true'}, {'_id': ObjectId('6380785b07237b8e1019136c'), 'name': 'ZZZZ', 'age': 23, 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('6380785b07237b8e1019136d'), 'name': 'HHH', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('63809c5a1e40573fe8eaa063'), 'name': 'BBBBBB', 'age': '2323', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('63809c5a1e40573fe8eaa064'), 'name': 'CCCCC', 'age': '20', 'adress': 'Jalgao', 'married': True}, {'_id': ObjectId('6380a0bb0f8cd4e1cda88861'), 'name': 'ASDF', 'age': '40', 'adress': 'Bhelgao', 'married': False}, {'_id': ObjectId('6380a0bb0f8cd4e1cda88862'), 'name': 'FDSA', 'age': '83', 'adress': 'Pulgao', 'married': False}, {'_id': ObjectId('6384792f5752913d04906f63'), 'name': 'Swapnil', 'age': '19', 'adress': 'jammgao', 'married': False}, {'_id': ObjectId('6384792f5752913d04906f64'), 'name': 'Nilay', 'age': '9', 'adress': 'Mul', 'married': False}, {'_id': ObjectId('6385d45d2fdf1e6b693308ff'), 'name': 'Nilesh', 'age': '19', 'adress': 'jammgao', 'married': False}, {'_id': ObjectId('6385d45d2fdf1e6b69330900'), 'name': 'Monaj', 'age': '22', 'adress': 'Mul', 'married': False}, {'_id': ObjectId('637f680a87acd4324299f4be'), 'name': 'kk', 'age': '56', 'address': ['Pune', ' Nagpur'], 'hobbies': 'farming', 'married': True}, {'_id': ObjectId('637b65d75f524c72d2d317a1'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637cbb6d5ed1021da1cb377b'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf3'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f66f487acd4324299f4bb'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f70a7269e1ddb192f8bbd'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('637f73961e8d98b9bcc6abed'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('63845f0560fc76a2c766c221'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur', 'married': False}, {'_id': ObjectId('6377081b8fae0ba9a0db78cf'), 'name': 'ak', 'age': '28', 'address': 'Delhi'}, {'_id': ObjectId('637634cfda75e8409af585f8'), 'name': 'Nil', 'age': '27', 'address': 'LA'}, {'_id': ObjectId('6360e724fd5a3e4d438641be'), 'name': 'ggg', 'age': '26', 'address': 'Mumbai', 'hobbies': ['Cricket', 'Football']}, {'_id': ObjectId('6360e724fd5a3e4d438641bf'), 'name': 'xyz', 'age': '27', 'address': 'Mumbai', 'hobbies': ['Cooking', 'Sports']}, {'_id': ObjectId('637b65d75f524c72d2d317a0'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb377a'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf2'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4ba'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bbc'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abec'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c220'), 'name': 'gt', 'age': 21, 'address': 'Mumbai', 'married': True}, {'_id': ObjectId('6360e6b11c50d4c7808ab95c'), 'name': 'smt', 'age': '30', 'address': 'Nagpur', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6377881d41de59f19a0bf5ba'), 'name': 'smt', 'age': '34', 'address': 'Nagpur'}, {'_id': ObjectId('637b65d75f524c72d2d3179f'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb3779'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf1'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4b9'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bbb'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abeb'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c21f'), 'name': 'gh', 'age': 54, 'address': 'Nagpur', 'married': True}, {'_id': ObjectId('6360e6a13e5c2f58ce4b46a7'), 'name': 'abc', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364c201010edc2134ca77f5'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebc'), 'name': 'jk', 'age': '22', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d2d97e72b068e81cbb03'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports'], 'married': True}, {'_id': ObjectId('6364d52ad5fc322dbdad1b16'), 'name': 'jk', 'age': '26', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6364d6573b01b8fb134075c8'), 'name': 'jk', 'age': '28', 'address': 'Pune', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6375f439758a325328667231'), 'name': 'swap', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('637605d75e9cd23fcba7b9cb'), 'name': 'sk', 'age': '27', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637606572330a06b2e76adc8'), 'age': '26', 'name': 'swa', 'address': 'Pune', 'married': False}, {'_id': ObjectId('63760b7b72f053b9078a2c7b'), 'name': 'sss', 'age': '39', 'address': 'Pune', 'married': False}, {'_id': ObjectId('637632e6701a5d7b4f2e0a67'), 'name': 'ghj', 'age': '28', 'address': 'Pune'}, {'_id': ObjectId('637634afda75e8409af585f6'), 'name': 'swap', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6377081b8fae0ba9a0db78d0'), 'name': 'sl', 'age': '21', 'address': 'Pune'}, {'_id': ObjectId('63775b34d412ac8f13de7f4c'), 'name': 'nil', 'age': '27', 'address': 'Pune', 'married': False}, {'_id': ObjectId('6377873d30f0cd2e0cffbe06'), 'name': 'swap', 'age': '37', 'address': 'Pune'}, {'_id': ObjectId('637787c4eceefa863611c9aa'), 'name': 'sw', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6377880341de59f19a0bf5b8'), 'name': 'swap', 'age': '23', 'address': 'Pune'}, {'_id': ObjectId('6377a07c8c57abaa33e77fd7'), 'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('6377a0d68c57abaa33e77fd9'), 'name': 'dd', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('6377a440079e68777eb693cd'), 'name': 'swapnil', 'age': '28', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b241db05d894d07033e27'), 'name': 'pk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b248017a5389ef94cdd51'), 'name': 'kk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b256fceec39e270daedcb'), 'name': 'hj', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b25ef5fe29b6e92d01c15'), 'name': 'dk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b65d75f524c72d2d3179e'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637b7e4818a34b482f22171e'), 'name': 'kj', 'age': '27', 'address': 'Pune', 'married': True}, {'_id': ObjectId('637cbace37a50240f842eef3'), 'name': 'hj', 'age': '45', 'address': 'Pune', 'hobbies': ['farming', 'cooking'], 'marriage': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb3778'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637cd1adeb6a73cbc6d04c36'), 'name': 'hj', 'age': '34', 'address': 'Pune', 'hobbies': ['cricket', 'football'], 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf0'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4b8'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bba'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abea'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c21e'), 'name': 'hk', 'age': 34, 'address': 'Pune', 'married': True}, {'_id': ObjectId('6364b94d7853821924bc88b9'), 'name': 'Viola', 'address': 'Sideway 1633'}, {'_id': ObjectId('6360e6c8326d9224920daf3b'), 'name': 'bbb', 'age': '20', 'address': 'Solapur', 'hobbies': ['Football', 'cooking']}, {'_id': ObjectId('637b65d75f524c72d2d317a3'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637cbb6d5ed1021da1cb377d'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf5'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f66f487acd4324299f4bd'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f70a7269e1ddb192f8bbf'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637f73961e8d98b9bcc6abef'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('63845f0560fc76a2c766c223'), 'name': 'gr', 'age': 43, 'address': 'Solapur', 'married': False}, {'_id': ObjectId('637b65d75f524c72d2d317a2'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637cbb6d5ed1021da1cb377c'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf4'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f66f487acd4324299f4bc'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f70a7269e1ddb192f8bbe'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637f73961e8d98b9bcc6abee'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('63845f0560fc76a2c766c222'), 'name': 'hn', 'age': 21, 'address': 'Warora', 'married': True}, {'_id': ObjectId('637211940fbe560932592ce1'), 'name': 'sushant', 'age': '500', 'address': 'baramati'}, {'_id': ObjectId('637b874ac5be986212e08548'), 'name': 'sl', 'age': '500', 'address': 'baramati', 'hobbies': ['treading', 'cricket'], 'married': True}, {'_id': ObjectId('6364b94d7853821924bc88b8'), 'name': 'Chuck', 'address': 'chennai'}, {'_id': ObjectId('637b859ae669eaf727e22f06'), 'name': 'pk', 'age': '55', 'address': 'gotkhindi', 'hobbies': ['farming', 'cricket'], 'married': 'true'}, {'_id': ObjectId('6364ba6427633429653326e8'), 'name': 'Chuck', 'address': 'kolkata'}, {'_id': ObjectId('63775b4ad412ac8f13de7f4e'), 'name': 'sk', 'age': '30', 'address': 'nagpur', 'married': True}, {'_id': ObjectId('637b820a8f7e55363b237e3f'), 'name': 'jk', 'age': '26', 'address': 'pune', 'hobbies': [''], 'married': [True]}, {'_id': ObjectId('637cba46fc3037333b279ded'), 'name': 'hj', 'age': '34', 'address': 'pune', 'hobbies': ['farming', 'football'], 'married': True}, {'_id': ObjectId('637b86a763f1a906027a77f4'), 'name': 'p', 'age': '5', 'address': 's', 'hobbies': ['cooking', 'cricket'], 'married': True}])  


    # def test_15(self):
    #     host = "localhost"                         
    #     port ="27017"                        # limit 4 
    #     database_name = "demoDatabase"
    #     table_name = "user_details"
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[ {'name': 'smt', 'age': '30', 'address': 'Nagpur', 'hobbies': ['news', 'Sports']}, {'_id': ObjectId('6360e6c8326d9224920daf3b'), 'name': 'bbb', 'age': '20', 'address': 'Solapur', 'hobbies': ['Football', 'cooking']}, {'_id': ObjectId('6360e724fd5a3e4d438641be'), 'name': 'ggg', 'age': '26', 'address': 'Mumbai', 'hobbies': ['Cricket', 'Football']}, {'_id': ObjectId('6360e724fd5a3e4d438641bf'), 'name': 'xyz', 'age': '27', 'address': 'Mumbai', 'hobbies': ['Cooking', 'Sports']}]] 



    # def test_16(self):
    #     host = "localhost"                         
    #     port ="27017"                        
    #     database_name = "demoDatabase"
    #     table_name = "user_details"            #[{'$project': {'name': 1, 'age': 1, 'address': 1}}]
    #     column_name = []
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)
       

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': ObjectId('6360e6a13e5c2f58ce4b46a7'), 'name': 'abc', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6360e6b11c50d4c7808ab95c'), 'name': 'smt', 'age': '30', 'address': 'Nagpur'}, {'_id': ObjectId('6360e6c8326d9224920daf3b'), 'name': 'bbb', 'age': '20', 'address': 'Solapur'}, {'_id': ObjectId('6360e724fd5a3e4d438641be'), 'name': 'ggg', 'age': '26', 'address': 'Mumbai'}, {'_id': ObjectId('6360e724fd5a3e4d438641bf'), 'name': 'xyz', 'age': '27', 'address': 'Mumbai'}, {'_id': ObjectId('6364b94d7853821924bc88b8'), 'name': 'Chuck', 'address': 'chennai'}, {'_id': ObjectId('6364b94d7853821924bc88b9'), 'name': 'Viola', 'address': 'Sideway 1633'}, {'_id': ObjectId('6364ba6427633429653326e8'), 'name': 'Chuck', 'address': 'kolkata'}, {'_id': ObjectId('6364c19ab2ad1011a4a18a2c'), 'name': 'jk', 'age': '32', 'address': 'Pune'}, {'_id': ObjectId('6364c201010edc2134ca77f5'), 'name': 'jk', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6364c201010edc2134ca77f6'), 'name': 'sl'}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebc'), 'name': 'jk', 'age': '22', 'address': 'Pune'}, {'_id': ObjectId('6364c4fe3658f958cf4e5ebd'), 'name': 'sl'}, {'_id': ObjectId('6364d2d97e72b068e81cbb03'), 'name': 'jk', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6364d52ad5fc322dbdad1b16'), 'name': 'jk', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6364d6573b01b8fb134075c8'), 'name': 'jk', 'age': '28', 'address': 'Pune'}, {'_id': ObjectId('6365032d6948fd52f2ccede4'), 'name': 'jk', 'age': '26'}, {'_id': ObjectId('63650351084cc86a27a429af'), 'name': 'jayant', 'age': '16'}, {'_id': ObjectId('636503567658a522a79fa0cd'), 'name': 'jayant', 'age': '23'}, {'_id': ObjectId('636503a0cf48a2c4af369d83'), 'name': 'jayant'}, {'_id': ObjectId('636503a4fa3a34fe2c4a138c'), 'name': 'jayant'}, {'_id': ObjectId('637211940fbe560932592ce1'), 'name': 'sushant', 'age': '500', 'address': 'baramati'}, {'_id': ObjectId('6375f439758a325328667231'), 'name': 'swap', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('637605d75e9cd23fcba7b9cb'), 'name': 'sk', 'age': '27', 'address': 'Pune'}, {'_id': ObjectId('637606572330a06b2e76adc8'), 'age': '26', 'name': 'swa', 'address': 'Pune'}, {'_id': ObjectId('63760b7b72f053b9078a2c7b'), 'name': 'sss', 'age': '39', 'address': 'Pune'}, {'_id': ObjectId('637632e6701a5d7b4f2e0a67'), 'name': 'ghj', 'age': '28', 'address': 'Pune'}, {'_id': ObjectId('637634afda75e8409af585f6'), 'name': 'swap', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('637634cfda75e8409af585f8'), 'name': 'Nil', 'age': '27', 'address': 'LA'}, {'_id': ObjectId('6377081b8fae0ba9a0db78cf'), 'name': 'ak', 'age': '28', 'address': 'Delhi'}, {'_id': ObjectId('6377081b8fae0ba9a0db78d0'), 'name': 'sl', 'age': '21', 'address': 'Pune'}, {'_id': ObjectId('63775896e73f610f622d2ddd'), 'name': 'swap', 'age': '27'}, {'_id': ObjectId('637758b3e73f610f622d2ddf'), 'name': 'jk', 'age': '28'}, {'_id': ObjectId('63775b34d412ac8f13de7f4c'), 'name': 'nil', 'age': '27', 'address': 'Pune'}, {'_id': ObjectId('63775b4ad412ac8f13de7f4e'), 'name': 'sk', 'age': '30', 'address': 'nagpur'}, {'_id': ObjectId('6377873d30f0cd2e0cffbe06'), 'name': 'swap', 'age': '37', 'address': 'Pune'}, {'_id': ObjectId('637787c4eceefa863611c9aa'), 'name': 'sw', 'age': '26', 'address': 'Pune'}, {'_id': ObjectId('6377880341de59f19a0bf5b8'), 'name': 'swap', 'age': '23', 'address': 'Pune'}, {'_id': ObjectId('6377881d41de59f19a0bf5ba'), 'name': 'smt', 'age': '34', 'address': 'Nagpur'}, {'_id': ObjectId('63779caac65aa5befc21b553'), 'name': 'dd', 'age': '23'}, {'_id': ObjectId('6377a07c8c57abaa33e77fd7'), 'name': 'dd', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('6377a0d68c57abaa33e77fd9'), 'name': 'dd', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('6377a440079e68777eb693cd'), 'name': 'swapnil', 'age': '28', 'address': 'Pune'}, {'_id': ObjectId('637b241db05d894d07033e27'), 'name': 'pk', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('637b248017a5389ef94cdd51'), 'name': 'kk', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('637b256fceec39e270daedcb'), 'name': 'hj', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('637b25ef5fe29b6e92d01c15'), 'name': 'dk', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('637b2fd07c6541328e50ccb5'), 'name': 'jk', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('637b65d75f524c72d2d3179e'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('637b65d75f524c72d2d3179f'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('637b65d75f524c72d2d317a0'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('637b65d75f524c72d2d317a1'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('637b65d75f524c72d2d317a2'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('637b65d75f524c72d2d317a3'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('637b7e4818a34b482f22171e'), 'name': 'kj', 'age': '27', 'address': 'Pune'}, {'_id': ObjectId('637b820a8f7e55363b237e3f'), 'name': 'jk', 'age': '26', 'address': 'pune'}, {'_id': ObjectId('637b859ae669eaf727e22f06'), 'name': 'pk', 'age': '55', 'address': 'gotkhindi'}, {'_id': ObjectId('637b86a763f1a906027a77f4'), 'name': 'p', 'age': '5', 'address': 's'}, {'_id': ObjectId('637b874ac5be986212e08548'), 'name': 'sl', 'age': '500', 'address': 'baramati'}, {'_id': ObjectId('637cba46fc3037333b279ded'), 'name': 'hj', 'age': '34', 'address': 'pune'}, {'_id': ObjectId('637cbace37a50240f842eef3'), 'name': 'hj', 'age': '45', 'address': 'Pune'}, {'_id': ObjectId('637cbb6d5ed1021da1cb3778'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('637cbb6d5ed1021da1cb3779'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('637cbb6d5ed1021da1cb377a'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('637cbb6d5ed1021da1cb377b'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('637cbb6d5ed1021da1cb377c'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('637cbb6d5ed1021da1cb377d'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('637cd1adeb6a73cbc6d04c36'), 'name': 'hj', 'age': '34', 'address': 'Pune'}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf0'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf1'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf2'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf3'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf4'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('637f4a0c8a598bf6a2eeaaf5'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('637f66f487acd4324299f4b8'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('637f66f487acd4324299f4b9'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('637f66f487acd4324299f4ba'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('637f66f487acd4324299f4bb'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('637f66f487acd4324299f4bc'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('637f66f487acd4324299f4bd'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('637f680a87acd4324299f4be'), 'name': 'kk', 'age': '56', 'address': ['Pune', ' Nagpur']}, {'_id': ObjectId('637f70a7269e1ddb192f8bba'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('637f70a7269e1ddb192f8bbb'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('637f70a7269e1ddb192f8bbc'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('637f70a7269e1ddb192f8bbd'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('637f70a7269e1ddb192f8bbe'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('637f70a7269e1ddb192f8bbf'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('637f73961e8d98b9bcc6abea'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('637f73961e8d98b9bcc6abeb'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('637f73961e8d98b9bcc6abec'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('637f73961e8d98b9bcc6abed'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('637f73961e8d98b9bcc6abee'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('637f73961e8d98b9bcc6abef'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('637f791ecb5af7428e205a18'), 'name': 'AAAAAAA', 'age': '2323'}, {'_id': ObjectId('637f827224f45440e76adf94'), 'name': '12edf', 'age': '2323'}, {'_id': ObjectId('63806eeb494c0ff2f6dd17e6')}, {'_id': ObjectId('63806f5c32fc86f60b2ec7e2')}, {'_id': ObjectId('63806fa10992f4f28b77b25f')}, {'_id': ObjectId('6380785b07237b8e1019136c'), 'name': 'ZZZZ', 'age': 23}, {'_id': ObjectId('6380785b07237b8e1019136d'), 'name': 'HHH', 'age': '20'}, {'_id': ObjectId('63809c5a1e40573fe8eaa063'), 'name': 'BBBBBB', 'age': '2323'}, {'_id': ObjectId('63809c5a1e40573fe8eaa064'), 'name': 'CCCCC', 'age': '20'}, {'_id': ObjectId('6380a0bb0f8cd4e1cda88861'), 'name': 'ASDF', 'age': '40'}, {'_id': ObjectId('6380a0bb0f8cd4e1cda88862'), 'name': 'FDSA', 'age': '83'}, {'_id': ObjectId('63845f0560fc76a2c766c21e'), 'name': 'hk', 'age': 34, 'address': 'Pune'}, {'_id': ObjectId('63845f0560fc76a2c766c21f'), 'name': 'gh', 'age': 54, 'address': 'Nagpur'}, {'_id': ObjectId('63845f0560fc76a2c766c220'), 'name': 'gt', 'age': 21, 'address': 'Mumbai'}, {'_id': ObjectId('63845f0560fc76a2c766c221'), 'name': 'bg', 'age': 32, 'address': 'Chandrapur'}, {'_id': ObjectId('63845f0560fc76a2c766c222'), 'name': 'hn', 'age': 21, 'address': 'Warora'}, {'_id': ObjectId('63845f0560fc76a2c766c223'), 'name': 'gr', 'age': 43, 'address': 'Solapur'}, {'_id': ObjectId('6384792f5752913d04906f63'), 'name': 'Swapnil', 'age': '19'}, {'_id': ObjectId('6384792f5752913d04906f64'), 'name': 'Nilay', 'age': '9'}, {'_id': ObjectId('6385d45d2fdf1e6b693308ff'), 'name': 'Nilesh', 'age': '19'}, {'_id': ObjectId('6385d45d2fdf1e6b69330900'), 'name': 'Monaj', 'age': '22'}])       

    
    # def test_17(self):
    #     host = "localhost"                         
    #     port ="27017"                        
    #     database_name = "demoDatabase"
    #     table_name = "user_details"            
    #     column_name = []                       #[{'$group': {'_id': '$age'}}]
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'_id': '30'}, {'_id': '26'}, {'_id': 23}, {'_id': '40'}, {'_id': 34}, {'_id': '9'}, {'_id': '32'}, {'_id': '16'}, {'_id': '37'}, {'_id': '28'}, {'_id': '23'}, {'_id': '27'}, {'_id': '55'}, {'_id': 21}, {'_id': '45'}, {'_id': '20'}, {'_id': '34'}, {'_id': 54}, {'_id': None}, {'_id': '39'}, {'_id': '21'}, {'_id': 43}, {'_id': '83'}, {'_id': '5'}, {'_id': '19'}, {'_id': '56'}, {'_id': '500'}, {'_id': '22'}, {'_id': '2323'}, {'_id': 32}])

    # def test_18(self):
    #     host = "localhost"                         
    #     port ="27017"                        
    #     database_name = "demoDatabase"
    #     table_name = "user_details"            
    #     column_name = []                       
    #     where = {}
    #     query_agg = query_generator()
    #     conn_str = f"mongodb://{host}:{port}/"
    #     sm = conn(conn_str,database_name,table_name)

    #     self.assertEqual(sm.connection(column_name,where,query_agg),[{'name': 'jk', 'age': '32', 'address': 'Pune'}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '22', 'address': 'Pune'}, {'name': 'jk', 'age': '26', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '26', 'address': 'Pune'}, {'name': 'jk', 'age': '28', 'address': 'Pune'}, {'name': 'jk', 'age': '26'}, {'name': 'jk', 'age': '28', 'adress': 'Pune', 'married': False}, {'name': 'jk', 'age': '34', 'address': 'Pune', 'married': True}, {'name': 'jk', 'age': '26', 'address': 'pune', 'married': [True]}])    

if __name__ == '__main__':
    unittest.main()  
    # tsm=TestStringMethods()
    # tsm.main()
    